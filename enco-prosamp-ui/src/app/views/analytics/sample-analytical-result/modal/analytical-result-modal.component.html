<!-- analytical-result-modal.component.html -->

<div class="modal-backdrop fade show"></div>
<div class="modal fade show d-block" tabindex="-1">
  <div class="modal-dialog" style="max-width: 1600px;">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Analytical Results for {{ sample.sampleIdentifier }}</h5>
        <button type="button" class="btn-close" (click)="onCancel()"></button>
      </div>
      <div class="modal-body">
        <div class="table-responsive">

          <form>
            <table class="table table-bordered">
              <thead>
              <tr>
                <th>Szennyezőanyag</th>
                <th>Fő</th>
                <th>Kontroll</th>
                <th>Fő+kontrolll</th>
                <th>Mértékegység</th>
                <th>&lt; nd?</th>
                <th>Kimutatási határ</th>
                <th>Bizonytalanség (%)</th>
                <th>Módszer</th>
                <th>Dátum</th>
                <th>Vizsgálati jegyzőkönyv</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let c of data.contaminants">
                <ng-container *ngIf="data.results.get(c.id) as result">
                  <td>{{ c.contaminant.name }}</td>

                  <td>
                    <input
                      type="number"
                      step="0.0001"
                      inputmode="decimal"
                      class="form-control input-min"
                      [(ngModel)]="result.resultMain"
                      name="main-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="number"
                      step="0.0001"
                      inputmode="decimal"
                      class="form-control input-min"
                      [(ngModel)]="result.resultControl"
                      name="control-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="number"
                      step="0.0001"
                      inputmode="decimal"
                      class="form-control input-min"
                      [(ngModel)]="result.resultMainControl"
                      name="mainControl-{{c.id}}"/>
                  </td>

                  <td>
                    <select class="form-select"
                            [(ngModel)]="result.resultMeasurementUnitId"
                            name="unit-{{c.id}}">
                      <option *ngFor="let unit of measurementUnits" [value]="unit.id">
                        {{ unit.unitCode }}
                      </option>
                    </select>
                  </td>

                  <td class="text-center input-min">
                    <input type="checkbox"
                           [(ngModel)]="result.isBelowDetectionLimit"
                           name="bdl-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="number"
                      step="0.0001"
                      inputmode="decimal"
                      class="form-control input-min"
                      [(ngModel)]="result.detectionLimit"
                      name="dl-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="number"
                      step="0.01"
                      inputmode="decimal"
                      class="form-control input-min"
                      [(ngModel)]="result.measurementUncertainty"
                      name="uncertainty-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="text"
                      maxlength="255"
                      class="form-control input-min"
                      [(ngModel)]="result.analysisMethod"
                      name="method-{{c.id}}"/>
                  </td>

                  <td>
                    <input
                      type="datetime-local"
                      class="form-control input-min"
                      [(ngModel)]="result.analysisDate"
                      name="date-{{c.id}}"/>
                  </td>

                  <td>
                    <select class="form-select"
                            [(ngModel)]="result.labReportId"
                            name="report-{{c.id}}">
                      <option *ngFor="let report of labReports" [value]="report.id">
                        {{ report.reportNumber }}
                      </option>
                    </select>
                  </td>
                </ng-container>
              </tr>
              </tbody>
            </table>
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="onCancel()">Cancel</button>
        <button class="btn btn-success" (click)="onSave()">Save</button>
      </div>
    </div>
  </div>
</div>
