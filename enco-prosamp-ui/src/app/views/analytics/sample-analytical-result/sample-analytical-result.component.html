<!-- Sampling record modal -->
<app-sampling-record-lookup-modal
  [visible]="showLookupModal"
  (close)="handleModalClose()"
  (selected)="onSamplingRecordSelected($event)">
</app-sampling-record-lookup-modal>

<!-- Select button -->
<div class="text-end my-3">
  <button cButton color="primary" (click)="openRecordSelector()">Mintavételi jegyzőkönyv kiválasztása</button>
</div>

<!-- Spinner while loading -->
<div *ngIf="isLoading" class="d-flex justify-content-center my-4">
  <c-spinner color="primary" class="my-4 d-flex justify-content-center"></c-spinner>
</div>

<!-- Display selected record -->
<div *ngIf="selectedRecord && !isLoading">
  <h5 class="text-primary mb-4">Projekt: {{ selectedRecord.project.projectName }}</h5>

  <!-- Sample list -->
  <div class="row">
    <div class="col-md-6 col-lg-4 mb-3" *ngFor="let sample of samples">
      <div class="card shadow-sm h-100" (click)="openSampleModal(sample)" style="cursor: pointer;">
        <div class="card-body">
          <h6 class="card-title">{{ sample.sampleIdentifier }}</h6>
          <p class="card-text text-muted">{{ sample.location }}</p>
          <p class="small text-secondary">Azonosító: {{ sample.id }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal for sample -->
<app-analytical-result-modal
  *ngIf="selectedSample"
  [sample]="selectedSample"
  [data]="sampleDataMap.get(selectedSample.id)!"
  [measurementUnits]="measurementUnits"
  [labReports]="labReports"
  (save)="saveSampleResults($event)"
  (autosave)="autosaveSingleResult($event)"
  (close)="closeSampleModal()">
</app-analytical-result-modal>
